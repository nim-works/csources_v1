/* Generated by Nim Compiler v0.1.0-dev.20827 */
#define NIM_INTBITS 64

#include "nimbase.h"
#include <string.h>
#undef LANGUAGE_C
#undef MIPSEB
#undef MIPSEL
#undef PPC
#undef R3000
#undef R4000
#undef i386
#undef linux
#undef mips
#undef near
#undef far
#undef powerpc
#undef unix
#define nimfr_(x, y)
#define nimln_(x, y)
typedef struct NimStrPayload NimStrPayload;
typedef struct NimStringV2 NimStringV2;
typedef struct tyTuple__7q7q3E6Oj24ZNVJb9aonhAg tyTuple__7q7q3E6Oj24ZNVJb9aonhAg;
struct NimStrPayload {
NI cap;
NIM_CHAR data[SEQ_DECL_SIZE];
};
struct NimStringV2 {
NI len;
NimStrPayload* p;
};
struct tyTuple__7q7q3E6Oj24ZNVJb9aonhAg {
NimStringV2 Field0;
NimStringV2 Field1;
NimStringV2 Field2;
};
N_LIB_PRIVATE N_NIMCALL(NimStringV2, nosrelativePath)(NimStringV2 path, NimStringV2 base, NIM_CHAR sep);
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void);
static N_INLINE(NIM_BOOL, isEmpty__utilsZpathutils_105)(NimStringV2 x);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, nosgetCurrentDir)(void);
N_LIB_PRIVATE N_NIMCALL(void, eqcopy___system_3229)(NimStringV2* dest, NimStringV2 src);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, rawNewString)(NI space);
N_NIMCALL(NimStringV2, rawNewString)(NI cap);
N_LIB_PRIVATE N_NIMCALL(void, addNormalizePath__pureZpathnorm_78)(NimStringV2 x, NimStringV2* result, NI* state, NIM_CHAR dirSep);
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___system_3226)(NimStringV2* dest);
N_LIB_PRIVATE N_NIMCALL(NIM_BOOL, nosisAbsolute)(NimStringV2 path);
static N_INLINE(NimStringV2, slash___pureZos_133)(NimStringV2 head, NimStringV2 tail);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, nosjoinPath)(NimStringV2 head, NimStringV2 tail);
static N_INLINE(void, nimZeroMem)(void* p, NI size);
static N_INLINE(void, nimSetMem__systemZmemory_7)(void* a, int v, NI size);
N_LIB_PRIVATE N_NIMCALL(tyTuple__7q7q3E6Oj24ZNVJb9aonhAg, nossplitFile)(NimStringV2 path);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, slash___utilsZpathutils_101)(NimStringV2 base, NimStringV2 f);
extern NIM_BOOL nimInErrorMode__system_4174;
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void) {
	NIM_BOOL* result;
	result = (NIM_BOOL*)0;
	result = (&nimInErrorMode__system_4174);
	return result;
}
N_LIB_PRIVATE N_NIMCALL(NimStringV2, relativeTo__utilsZpathutils_150)(NimStringV2 fullPath, NimStringV2 baseFilename, NIM_CHAR sep) {
	NimStringV2 result;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result.len = 0; result.p = NIM_NIL;
	result = nosrelativePath(fullPath, baseFilename, sep);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
	return result;
}
static N_INLINE(NIM_BOOL, isEmpty__utilsZpathutils_105)(NimStringV2 x) {
	NIM_BOOL result;
	result = (NIM_BOOL)0;
	result = (x.len == ((NI) 0));
	return result;
}
N_LIB_PRIVATE N_NIMCALL(NimStringV2, slash___utilsZpathutils_126)(NimStringV2 base, NimStringV2 f) {
	NimStringV2 result;
	NimStringV2 base_2;
	NI state;
NIM_BOOL oldNimErrFin1_;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result.len = 0; result.p = NIM_NIL;
	base_2.len = 0; base_2.p = NIM_NIL;
	{
		{
			NIM_BOOL T5_;
			T5_ = (NIM_BOOL)0;
			T5_ = isEmpty__utilsZpathutils_105(base);
			if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
			if (!T5_) goto LA6_;
			base_2 = nosgetCurrentDir();
			if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
			goto LA2;
		}
		LA6_: ;
		eqcopy___system_3229((&base_2), base);
	} LA2: ;
	result = rawNewString(((NI) ((NI)(base_2.len + f.len))));
	state = ((NI) 0);
	addNormalizePath__pureZpathnorm_78(base_2, (&result), (&state), 92);
	if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
	addNormalizePath__pureZpathnorm_78(f, (&result), (&state), 92);
	if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
	{
		LA1_:;
	}
	{
		oldNimErrFin1_ = *nimErr_; *nimErr_ = NIM_FALSE;
		eqdestroy___system_3226((&base_2));
		*nimErr_ = oldNimErrFin1_;
	}
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
	return result;
}
static N_INLINE(NimStringV2, slash___pureZos_133)(NimStringV2 head, NimStringV2 tail) {
	NimStringV2 result;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result.len = 0; result.p = NIM_NIL;
	result = nosjoinPath(head, tail);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
	return result;
}
N_LIB_PRIVATE N_NIMCALL(NimStringV2, toAbsoluteDir__utilsZpathutils_83)(NimStringV2 path) {
	NimStringV2 result;
NIM_BOOL oldNimErrFin7_;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result.len = 0; result.p = NIM_NIL;
	{
		NimStringV2 colontmp__2;
		NimStringV2 colontmp__3;
		{
			NIM_BOOL T4_;
			NimStringV2* colontmp_;
			T4_ = (NIM_BOOL)0;
			T4_ = nosisAbsolute(path);
			if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
			if (!T4_) goto LA5_;
			colontmp_ = (&path);
			eqcopy___system_3229((&result), (*colontmp_));
			goto LA1;
		}
		LA5_: ;
		colontmp__2.len = 0; colontmp__2.p = NIM_NIL;
		colontmp__3 = nosgetCurrentDir();
		if (NIM_UNLIKELY(*nimErr_)) goto LA7_;
		colontmp__2 = colontmp__3;
		result = slash___pureZos_133(colontmp__2, path);
		if (NIM_UNLIKELY(*nimErr_)) goto LA7_;
		{
			LA7_:;
		}
		{
			oldNimErrFin7_ = *nimErr_; *nimErr_ = NIM_FALSE;
			eqdestroy___system_3226((&colontmp__2));
			*nimErr_ = oldNimErrFin7_;
		}
		if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	} LA1: ;
	}BeforeRet_: ;
	return result;
}
N_LIB_PRIVATE N_NIMCALL(NimStringV2, slash___utilsZpathutils_101)(NimStringV2 base, NimStringV2 f) {
	NimStringV2 result;
	NimStringV2 base_2;
	NI state;
NIM_BOOL oldNimErrFin1_;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result.len = 0; result.p = NIM_NIL;
	base_2.len = 0; base_2.p = NIM_NIL;
	{
		{
			NIM_BOOL T5_;
			T5_ = (NIM_BOOL)0;
			T5_ = isEmpty__utilsZpathutils_105(base);
			if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
			if (!T5_) goto LA6_;
			base_2 = nosgetCurrentDir();
			if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
			goto LA2;
		}
		LA6_: ;
		eqcopy___system_3229((&base_2), base);
	} LA2: ;
	result = rawNewString(((NI) ((NI)(base_2.len + f.len))));
	state = ((NI) 0);
	addNormalizePath__pureZpathnorm_78(base_2, (&result), (&state), 92);
	if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
	addNormalizePath__pureZpathnorm_78(f, (&result), (&state), 92);
	if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
	{
		LA1_:;
	}
	{
		oldNimErrFin1_ = *nimErr_; *nimErr_ = NIM_FALSE;
		eqdestroy___system_3226((&base_2));
		*nimErr_ = oldNimErrFin1_;
	}
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
	return result;
}
static N_INLINE(void, nimSetMem__systemZmemory_7)(void* a, int v, NI size) {
	void* T1_;
	T1_ = (void*)0;
	T1_ = memset(a, v, ((size_t) (size)));
	(void)(T1_);
}
static N_INLINE(void, nimZeroMem)(void* p, NI size) {
	nimSetMem__systemZmemory_7(p, ((int) 0), size);
}
N_LIB_PRIVATE N_NIMCALL(tyTuple__7q7q3E6Oj24ZNVJb9aonhAg, splitFile__utilsZpathutils_29)(NimStringV2 x) {
	tyTuple__7q7q3E6Oj24ZNVJb9aonhAg result;
	tyTuple__7q7q3E6Oj24ZNVJb9aonhAg colontmp_;
	NimStringV2 a;
	NimStringV2 b;
	NimStringV2 c;
	NimStringV2 colontmp__2;
	NimStringV2* colontmp__3;
	NimStringV2 colontmp__4;
	NimStringV2 colontmp__5;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	nimZeroMem((void*)(&result), sizeof(tyTuple__7q7q3E6Oj24ZNVJb9aonhAg));
	colontmp_ = nossplitFile(x);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	a.len = 0; a.p = NIM_NIL;
	a = colontmp_.Field0;
	b.len = 0; b.p = NIM_NIL;
	b = colontmp_.Field1;
	c.len = 0; c.p = NIM_NIL;
	c = colontmp_.Field2;
	colontmp__2.len = 0; colontmp__2.p = NIM_NIL;
	colontmp__3 = (&a);
	colontmp__2 = (*colontmp__3);
	colontmp__4.len = 0; colontmp__4.p = NIM_NIL;
	colontmp__4 = b;
	colontmp__5.len = 0; colontmp__5.p = NIM_NIL;
	colontmp__5 = c;
	result.Field0 = colontmp__2;
	result.Field1 = colontmp__4;
	result.Field2 = colontmp__5;
	}BeforeRet_: ;
	return result;
}
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___utilsZpathutils_53)(tyTuple__7q7q3E6Oj24ZNVJb9aonhAg* dest) {
	eqdestroy___system_3226((&(*dest).Field0));
	eqdestroy___system_3226((&(*dest).Field1));
	eqdestroy___system_3226((&(*dest).Field2));
}
N_LIB_PRIVATE N_NIMCALL(NimStringV2, toAbsolute__utilsZpathutils_155)(NimStringV2 file, NimStringV2 base) {
	NimStringV2 result;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result.len = 0; result.p = NIM_NIL;
	{
		{
			NIM_BOOL T4_;
			NimStringV2* colontmp_;
			T4_ = (NIM_BOOL)0;
			T4_ = nosisAbsolute(file);
			if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
			if (!T4_) goto LA5_;
			colontmp_ = (&file);
			eqcopy___system_3229((&result), (*colontmp_));
			goto LA1;
		}
		LA5_: ;
		result = slash___utilsZpathutils_101(base, file);
		if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	} LA1: ;
	}BeforeRet_: ;
	return result;
}
